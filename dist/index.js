import{createRequire as b0} from"node:module";var E0=Object.create;var{defineProperty:r,getPrototypeOf:C0,getOwnPropertyNames:P0}=Object;var F0=Object.prototype.hasOwnProperty;var M0=(q,$,Q)=>{Q=q!=null?E0(C0(q)):{};const U=$||!q||!q.__esModule?r(Q,"default",{value:q,enumerable:!0}):Q;for(let X of P0(q))if(!F0.call(U,X))r(U,X,{get:()=>q[X],enumerable:!0});return U};var L=(q,$)=>()=>($||q(($={exports:{}}).exports,$),$.exports);var _=b0(import.meta.url);var K0=L((f1,r0)=>{r0.exports={name:"dotenv",version:"16.4.5",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec","test:coverage":"tap --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://dotenvx.com",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3",decache:"^4.6.1",sinon:"^14.0.1",standard:"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0",tap:"^16.3.0",tar:"^6.1.11",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var H0=L((h1,A)=>{var q1=function(q){const $={};let Q=q.toString();Q=Q.replace(/\r\n?/mg,"\n");let U;while((U=e0.exec(Q))!=null){const X=U[1];let Z=U[2]||"";Z=Z.trim();const G=Z[0];if(Z=Z.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),G==='"')Z=Z.replace(/\\n/g,"\n"),Z=Z.replace(/\\r/g,"\r");$[X]=Z}return $},$1=function(q){const $=j0(q),Q=H.configDotenv({path:$});if(!Q.parsed){const G=new Error(`MISSING_DATA: Cannot parse ${$} for an unknown reason`);throw G.code="MISSING_DATA",G}const U=J0(q).split(","),X=U.length;let Z;for(let G=0;G<X;G++)try{const z=U[G].trim(),K=X1(Q,z);Z=H.decrypt(K.ciphertext,K.key);break}catch(z){if(G+1>=X)throw z}return H.parse(Z)},Q1=function(q){console.log(`[dotenv@${n}][INFO] ${q}`)},U1=function(q){console.log(`[dotenv@${n}][WARN] ${q}`)},m=function(q){console.log(`[dotenv@${n}][DEBUG] ${q}`)},J0=function(q){if(q&&q.DOTENV_KEY&&q.DOTENV_KEY.length>0)return q.DOTENV_KEY;if(process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0)return process.env.DOTENV_KEY;return""},X1=function(q,$){let Q;try{Q=new URL($)}catch(z){if(z.code==="ERR_INVALID_URL"){const K=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw K.code="INVALID_DOTENV_KEY",K}throw z}const U=Q.password;if(!U){const z=new Error("INVALID_DOTENV_KEY: Missing key part");throw z.code="INVALID_DOTENV_KEY",z}const X=Q.searchParams.get("environment");if(!X){const z=new Error("INVALID_DOTENV_KEY: Missing environment part");throw z.code="INVALID_DOTENV_KEY",z}const Z=`DOTENV_VAULT_${X.toUpperCase()}`,G=q.parsed[Z];if(!G){const z=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${Z} in your .env.vault file.`);throw z.code="NOT_FOUND_DOTENV_ENVIRONMENT",z}return{ciphertext:G,key:U}},j0=function(q){let $=null;if(q&&q.path&&q.path.length>0)if(Array.isArray(q.path)){for(let Q of q.path)if(i.existsSync(Q))$=Q.endsWith(".vault")?Q:`${Q}.vault`}else $=q.path.endsWith(".vault")?q.path:`${q.path}.vault`;else $=l.resolve(process.cwd(),".env.vault");if(i.existsSync($))return $;return null},O0=function(q){return q[0]==="~"?l.join(s0.homedir(),q.slice(1)):q},Z1=function(q){Q1("Loading env from encrypted .env.vault");const $=H._parseVault(q);let Q=process.env;if(q&&q.processEnv!=null)Q=q.processEnv;return H.populate(Q,$,q),{parsed:$}},G1=function(q){const $=l.resolve(process.cwd(),".env");let Q="utf8";const U=Boolean(q&&q.debug);if(q&&q.encoding)Q=q.encoding;else if(U)m("No encoding is specified. UTF-8 is used by default");let X=[$];if(q&&q.path)if(!Array.isArray(q.path))X=[O0(q.path)];else{X=[];for(let K of q.path)X.push(O0(K))}let Z;const G={};for(let K of X)try{const W=H.parse(i.readFileSync(K,{encoding:Q}));H.populate(G,W,q)}catch(W){if(U)m(`Failed to load ${K} ${W.message}`);Z=W}let z=process.env;if(q&&q.processEnv!=null)z=q.processEnv;if(H.populate(z,G,q),Z)return{parsed:G,error:Z};else return{parsed:G}},B1=function(q){if(J0(q).length===0)return H.configDotenv(q);const $=j0(q);if(!$)return U1(`You set DOTENV_KEY but you are missing a .env.vault file at ${$}. Did you forget to build it?`),H.configDotenv(q);return H._configVault(q)},z1=function(q,$){const Q=Buffer.from($.slice(-64),"hex");let U=Buffer.from(q,"base64");const X=U.subarray(0,12),Z=U.subarray(-16);U=U.subarray(12,-16);try{const G=o0.createDecipheriv("aes-256-gcm",Q,X);return G.setAuthTag(Z),`${G.update(U)}${G.final()}`}catch(G){const z=G instanceof RangeError,K=G.message==="Invalid key length",W=G.message==="Unsupported state or unable to authenticate data";if(z||K){const O=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw O.code="INVALID_DOTENV_KEY",O}else if(W){const O=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw O.code="DECRYPTION_FAILED",O}else throw G}},K1=function(q,$,Q={}){const U=Boolean(Q&&Q.debug),X=Boolean(Q&&Q.override);if(typeof $!=="object"){const Z=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw Z.code="OBJECT_REQUIRED",Z}for(let Z of Object.keys($))if(Object.prototype.hasOwnProperty.call(q,Z)){if(X===!0)q[Z]=$[Z];if(U)if(X===!0)m(`"${Z}" is already defined and WAS overwritten`);else m(`"${Z}" is already defined and was NOT overwritten`)}else q[Z]=$[Z]},i=_("fs"),l=_("path"),s0=_("os"),o0=_("crypto"),t0=K0(),n=t0.version,e0=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg,H={configDotenv:G1,_configVault:Z1,_parseVault:$1,config:B1,decrypt:z1,parse:q1,populate:K1};h1.configDotenv=H.configDotenv;h1._configVault=H._configVault;h1._parseVault=H._parseVault;h1.config=H.config;h1.decrypt=H.decrypt;h1.parse=H.parse;h1.populate=H.populate;A.exports=H});var V0=L((_1,W0)=>{var D={};if(process.env.DOTENV_CONFIG_ENCODING!=null)D.encoding=process.env.DOTENV_CONFIG_ENCODING;if(process.env.DOTENV_CONFIG_PATH!=null)D.path=process.env.DOTENV_CONFIG_PATH;if(process.env.DOTENV_CONFIG_DEBUG!=null)D.debug=process.env.DOTENV_CONFIG_DEBUG;if(process.env.DOTENV_CONFIG_OVERRIDE!=null)D.override=process.env.DOTENV_CONFIG_OVERRIDE;if(process.env.DOTENV_CONFIG_DOTENV_KEY!=null)D.DOTENV_KEY=process.env.DOTENV_CONFIG_DOTENV_KEY;W0.exports=D});var w0=L((v1,Y0)=>{var w1=/^dotenv_config_(encoding|path|debug|override|DOTENV_KEY)=(.+)$/;Y0.exports=function q($){return $.reduce(function(Q,U){const X=U.match(w1);if(X)Q[X[1]]=X[2];return Q},{})}});var I0=L(()=>{(function(){H0().config(Object.assign({},V0(),w0()(process.argv)))})()});var x0=function(){const q=new Map;for(let[$,Q]of Object.entries(J)){for(let[U,X]of Object.entries(Q))J[U]={open:`\x1B[${X[0]}m`,close:`\x1B[${X[1]}m`},Q[U]=J[U],q.set(X[0],X[1]);Object.defineProperty(J,$,{value:Q,enumerable:!1})}return Object.defineProperty(J,"codes",{value:q,enumerable:!1}),J.color.close="\x1B[39m",J.bgColor.close="\x1B[49m",J.color.ansi=s(),J.color.ansi256=o(),J.color.ansi16m=t(),J.bgColor.ansi=s(10),J.bgColor.ansi256=o(10),J.bgColor.ansi16m=t(10),Object.defineProperties(J,{rgbToAnsi256:{value($,Q,U){if($===Q&&Q===U){if($<8)return 16;if($>248)return 231;return Math.round(($-8)/247*24)+232}return 16+36*Math.round($/255*5)+6*Math.round(Q/255*5)+Math.round(U/255*5)},enumerable:!1},hexToRgb:{value($){const Q=/[a-f\d]{6}|[a-f\d]{3}/i.exec($.toString(16));if(!Q)return[0,0,0];let[U]=Q;if(U.length===3)U=[...U].map((Z)=>Z+Z).join("");const X=Number.parseInt(U,16);return[X>>16&255,X>>8&255,X&255]},enumerable:!1},hexToAnsi256:{value:($)=>J.rgbToAnsi256(...J.hexToRgb($)),enumerable:!1},ansi256ToAnsi:{value($){if($<8)return 30+$;if($<16)return 90+($-8);let Q,U,X;if($>=232)Q=(($-232)*10+8)/255,U=Q,X=Q;else{$-=16;const z=$%36;Q=Math.floor($/36)/5,U=Math.floor(z/6)/5,X=z%6/5}const Z=Math.max(Q,U,X)*2;if(Z===0)return 30;let G=30+(Math.round(X)<<2|Math.round(U)<<1|Math.round(Q));if(Z===2)G+=60;return G},enumerable:!1},rgbToAnsi:{value:($,Q,U)=>J.ansi256ToAnsi(J.rgbToAnsi256($,Q,U)),enumerable:!1},hexToAnsi:{value:($)=>J.ansi256ToAnsi(J.hexToAnsi256($)),enumerable:!1}}),J};var s=(q=0)=>($)=>`\x1B[${$+q}m`,o=(q=0)=>($)=>`\x1B[${38+q};5;${$}m`,t=(q=0)=>($,Q,U)=>`\x1B[${38+q};2;${$};${Q};${U}m`,J={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},R1=Object.keys(J.modifier),D0=Object.keys(J.color),L0=Object.keys(J.bgColor),A1=[...D0,...L0],k0=x0(),N=k0;import c from"node:process";import T0 from"node:os";import e from"node:tty";var I=function(q,$=globalThis.Deno?globalThis.Deno.args:c.argv){const Q=q.startsWith("-")?"":q.length===1?"-":"--",U=$.indexOf(Q+q),X=$.indexOf("--");return U!==-1&&(X===-1||U<X)},S0=function(){if("FORCE_COLOR"in j){if(j.FORCE_COLOR==="true")return 1;if(j.FORCE_COLOR==="false")return 0;return j.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(j.FORCE_COLOR,10),3)}},f0=function(q){if(q===0)return!1;return{level:q,hasBasic:!0,has256:q>=2,has16m:q>=3}},h0=function(q,{streamIsTTY:$,sniffFlags:Q=!0}={}){const U=S0();if(U!==void 0)v=U;const X=Q?v:U;if(X===0)return 0;if(Q){if(I("color=16m")||I("color=full")||I("color=truecolor"))return 3;if(I("color=256"))return 2}if("TF_BUILD"in j&&"AGENT_NAME"in j)return 1;if(q&&!$&&X===void 0)return 0;const Z=X||0;if(j.TERM==="dumb")return Z;if(c.platform==="win32"){const G=T0.release().split(".");if(Number(G[0])>=10&&Number(G[2])>=10586)return Number(G[2])>=14931?3:2;return 1}if("CI"in j){if("GITHUB_ACTIONS"in j||"GITEA_ACTIONS"in j)return 3;if(["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some((G)=>(G in j))||j.CI_NAME==="codeship")return 1;return Z}if("TEAMCITY_VERSION"in j)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(j.TEAMCITY_VERSION)?1:0;if(j.COLORTERM==="truecolor")return 3;if(j.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in j){const G=Number.parseInt((j.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(j.TERM_PROGRAM){case"iTerm.app":return G>=3?3:2;case"Apple_Terminal":return 2}}if(/-256(color)?$/i.test(j.TERM))return 2;if(/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(j.TERM))return 1;if("COLORTERM"in j)return 1;return Z};function q0(q,$={}){const Q=h0(q,{streamIsTTY:q&&q.isTTY,...$});return f0(Q)}var{env:j}=c,v;if(I("no-color")||I("no-colors")||I("color=false")||I("color=never"))v=0;else if(I("color")||I("colors")||I("color=true")||I("color=always"))v=1;var _0={stdout:q0({isTTY:e.isatty(1)}),stderr:q0({isTTY:e.isatty(2)})},$0=_0;function Q0(q,$,Q){let U=q.indexOf($);if(U===-1)return q;const X=$.length;let Z=0,G="";do G+=q.slice(Z,U)+$+Q,Z=U+X,U=q.indexOf($,Z);while(U!==-1);return G+=q.slice(Z),G}function U0(q,$,Q,U){let X=0,Z="";do{const G=q[U-1]==="\r";Z+=q.slice(X,G?U-1:U)+$+(G?"\r\n":"\n")+Q,X=U+1,U=q.indexOf("\n",X)}while(U!==-1);return Z+=q.slice(X),Z}var k=function(q){return y0(q)};var{stdout:X0,stderr:Z0}=$0,p=Symbol("GENERATOR"),M=Symbol("STYLER"),x=Symbol("IS_EMPTY"),G0=["ansi","ansi","ansi256","ansi16m"],b=Object.create(null),v0=(q,$={})=>{if($.level&&!(Number.isInteger($.level)&&$.level>=0&&$.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const Q=X0?X0.level:0;q.level=$.level===void 0?Q:$.level};var y0=(q)=>{const $=(...Q)=>Q.join(" ");return v0($,q),Object.setPrototypeOf($,k.prototype),$};Object.setPrototypeOf(k.prototype,Function.prototype);for(let[q,$]of Object.entries(N))b[q]={get(){const Q=y(this,d($.open,$.close,this[M]),this[x]);return Object.defineProperty(this,q,{value:Q}),Q}};b.visible={get(){const q=y(this,this[M],!0);return Object.defineProperty(this,"visible",{value:q}),q}};var g=(q,$,Q,...U)=>{if(q==="rgb"){if($==="ansi16m")return N[Q].ansi16m(...U);if($==="ansi256")return N[Q].ansi256(N.rgbToAnsi256(...U));return N[Q].ansi(N.rgbToAnsi(...U))}if(q==="hex")return g("rgb",$,Q,...N.hexToRgb(...U));return N[Q][q](...U)},m0=["rgb","hex","ansi256"];for(let q of m0){b[q]={get(){const{level:Q}=this;return function(...U){const X=d(g(q,G0[Q],"color",...U),N.color.close,this[M]);return y(this,X,this[x])}}};const $="bg"+q[0].toUpperCase()+q.slice(1);b[$]={get(){const{level:Q}=this;return function(...U){const X=d(g(q,G0[Q],"bgColor",...U),N.bgColor.close,this[M]);return y(this,X,this[x])}}}}var u0=Object.defineProperties(()=>{},{...b,level:{enumerable:!0,get(){return this[p].level},set(q){this[p].level=q}}}),d=(q,$,Q)=>{let U,X;if(Q===void 0)U=q,X=$;else U=Q.openAll+q,X=$+Q.closeAll;return{open:q,close:$,openAll:U,closeAll:X,parent:Q}},y=(q,$,Q)=>{const U=(...X)=>c0(U,X.length===1?""+X[0]:X.join(" "));return Object.setPrototypeOf(U,u0),U[p]=q,U[M]=$,U[x]=Q,U},c0=(q,$)=>{if(q.level<=0||!$)return q[x]?"":$;let Q=q[M];if(Q===void 0)return $;const{openAll:U,closeAll:X}=Q;if($.includes("\x1B"))while(Q!==void 0)$=Q0($,Q.close,Q.open),Q=Q.parent;const Z=$.indexOf("\n");if(Z!==-1)$=U0($,X,U,Z);return U+$+X};Object.defineProperties(k.prototype,b);var p0=k(),k1=k({level:Z0?Z0.level:0});var F=p0;var g0=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,d0=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,i0=/[^-+\dA-Z]/g;function Y(q,$,Q,U){if(arguments.length===1&&typeof q==="string"&&!/\d/.test(q))$=q,q=void 0;if(q=q||q===0?q:new Date,!(q instanceof Date))q=new Date(q);if(isNaN(q))throw TypeError("Invalid date");$=String(B0[$]||$||B0.default);var X=$.slice(0,4);if(X==="UTC:"||X==="GMT:"){if($=$.slice(4),Q=!0,X==="GMT:")U=!0}var Z=function B(){return Q?"getUTC":"get"},G=function B(){return q[Z()+"Date"]()},z=function B(){return q[Z()+"Day"]()},K=function B(){return q[Z()+"Month"]()},W=function B(){return q[Z()+"FullYear"]()},O=function B(){return q[Z()+"Hours"]()},E=function B(){return q[Z()+"Minutes"]()},T=function B(){return q[Z()+"Seconds"]()},S=function B(){return q[Z()+"Milliseconds"]()},C=function B(){return Q?0:q.getTimezoneOffset()},f=function B(){return l0(q)},u=function B(){return n0(q)},h={d:function B(){return G()},dd:function B(){return w(G())},ddd:function B(){return V.dayNames[z()]},DDD:function B(){return z0({y:W(),m:K(),d:G(),_:Z(),dayName:V.dayNames[z()],short:!0})},dddd:function B(){return V.dayNames[z()+7]},DDDD:function B(){return z0({y:W(),m:K(),d:G(),_:Z(),dayName:V.dayNames[z()+7]})},m:function B(){return K()+1},mm:function B(){return w(K()+1)},mmm:function B(){return V.monthNames[K()]},mmmm:function B(){return V.monthNames[K()+12]},yy:function B(){return String(W()).slice(2)},yyyy:function B(){return w(W(),4)},h:function B(){return O()%12||12},hh:function B(){return w(O()%12||12)},H:function B(){return O()},HH:function B(){return w(O())},M:function B(){return E()},MM:function B(){return w(E())},s:function B(){return T()},ss:function B(){return w(T())},l:function B(){return w(S(),3)},L:function B(){return w(Math.floor(S()/10))},t:function B(){return O()<12?V.timeNames[0]:V.timeNames[1]},tt:function B(){return O()<12?V.timeNames[2]:V.timeNames[3]},T:function B(){return O()<12?V.timeNames[4]:V.timeNames[5]},TT:function B(){return O()<12?V.timeNames[6]:V.timeNames[7]},Z:function B(){return U?"GMT":Q?"UTC":a0(q)},o:function B(){return(C()>0?"-":"+")+w(Math.floor(Math.abs(C())/60)*100+Math.abs(C())%60,4)},p:function B(){return(C()>0?"-":"+")+w(Math.floor(Math.abs(C())/60),2)+":"+w(Math.floor(Math.abs(C())%60),2)},S:function B(){return["th","st","nd","rd"][G()%10>3?0:(G()%100-G()%10!=10)*G()%10]},W:function B(){return f()},WW:function B(){return w(f())},N:function B(){return u()}};return $.replace(g0,function(B){if(B in h)return h[B]();return B.slice(1,B.length-1)})}var B0={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},V={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},w=function q($){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String($).padStart(Q,"0")},z0=function q($){var{y:Q,m:U,d:X,_:Z,dayName:G,short:z}=$,K=z===void 0?!1:z,W=new Date,O=new Date;O.setDate(O[Z+"Date"]()-1);var E=new Date;E.setDate(E[Z+"Date"]()+1);var T=function P(){return W[Z+"Date"]()},S=function P(){return W[Z+"Month"]()},C=function P(){return W[Z+"FullYear"]()},f=function P(){return O[Z+"Date"]()},u=function P(){return O[Z+"Month"]()},h=function P(){return O[Z+"FullYear"]()},B=function P(){return E[Z+"Date"]()},R0=function P(){return E[Z+"Month"]()},A0=function P(){return E[Z+"FullYear"]()};if(C()===Q&&S()===U&&T()===X)return K?"Tdy":"Today";else if(h()===Q&&u()===U&&f()===X)return K?"Ysd":"Yesterday";else if(A0()===Q&&R0()===U&&B()===X)return K?"Tmw":"Tomorrow";return G},l0=function q($){var Q=new Date($.getFullYear(),$.getMonth(),$.getDate());Q.setDate(Q.getDate()-(Q.getDay()+6)%7+3);var U=new Date(Q.getFullYear(),0,4);U.setDate(U.getDate()-(U.getDay()+6)%7+3);var X=Q.getTimezoneOffset()-U.getTimezoneOffset();Q.setHours(Q.getHours()-X);var Z=(Q-U)/604800000;return 1+Math.floor(Z)},n0=function q($){var Q=$.getDay();if(Q===0)Q=7;return Q},a0=function q($){return(String($).match(d0)||[""]).pop().replace(i0,"").replace(/GMT\+0000/g,"UTC")};var p1=M0(I0(),1);import*as R from"node:fs";var a={show:{stdoutEnable:!0,mainProgram:!0,subProgram:!0,date:!0,dateformat:"yyyy-mm-dd HH:MM:ss:l Z",level:!0,ignoreLevels:process.env.ENVIRONMENT!="DEV"?["DEBUG"]:[]},logStorage:{path:"./logs",json:!0,txt:!0,splitBy:"day",stratagy:"batch",batch:6,ignoreLevels:process.env.ENVIRONMENT!="DEV"?["DEBUG"]:[]},logWebook:{enable:!1,url:"",form:""}};class N0{formatSettings;storageSettings;webhookSettings;mainProcess;subProcess;colours={FATAL:F.bgRedBright,ERROR:F.red,WARN:F.yellow,SUCCESS:F.green,INFO:F.blue,DEBUG:F.magenta};logBuffer=[];constructor(q,$,Q={}){try{this.mainProcess=q,this.subProcess=$}catch(U){console.error("There was an issue with initialising process names"),process.exit(1)}try{this.formatSettings={...a.show,...Q.show}}catch(U){console.error("There was an issue with initialising settings: format Settings",Q.show),process.exit(1)}try{this.storageSettings={...a.logStorage,...Q.logStorage}}catch(U){console.error("There was an issue with initialising settings: storage Settings",Q.logStorage),process.exit(1)}try{this.webhookSettings={...a.logWebook,...Q.logWebook}}catch(U){console.error("There was an issue with initialising settings: webhook Settings",Q.logWebook),process.exit(1)}try{this.success("Initialised Logger"),this.debug("Settings:\n"+JSON.stringify(this.formatSettings,null,4)),this.debug("\n"+JSON.stringify(this.storageSettings,null,4)),this.debug("\n"+JSON.stringify(this.webhookSettings,null,4)+"\n")}catch(U){console.error("There was an issue with logging settings"),process.exit(1)}}sendLog(q,$,Q){try{const U=new Date,X=Y(U,this.formatSettings.dateformat),Z=this.handleLogDatatype($),G=this.handleLogDatatype(Q),z=this.formTxtLog(X,Z,q,G);if(this.formatSettings.stdoutEnable&&!this.formatSettings.ignoreLevels.includes(q))console.log(this.colours[q](z));if((this.storageSettings.json||this.storageSettings.txt)&&!this.storageSettings.ignoreLevels.includes(q))this.logToFile(U,X,Z,q,G,z)}catch(U){console.error("There was an issue logging data",U)}}formTxtLog(q,$,Q,U){let X="";return X+=this.formatSettings.date?`[${q}] `:"",X+=this.formatSettings.mainProgram||this.formatSettings.subProgram?"<":"",X+=this.formatSettings.mainProgram?this.mainProcess:"",X+=this.formatSettings.mainProgram&&this.formatSettings.subProgram?".":"",X+=this.formatSettings.subProgram?this.subProcess:"",X+=this.formatSettings.mainProgram||this.formatSettings.subProgram?"> ":"",X+=this.formatSettings.level?`[${Q}] `:"",X+=$,X+=U!=""?"\nLog Data:\n"+U:"",X}logToFile(q,$,Q,U,X,Z){const G={date:q,formattedDate:$,mainProcess:this.mainProcess,subProcess:this.subProcess,logLevel:U,logMessage:Q,logData:X};let z="";try{z=JSON.stringify(G)}catch(K){this.error("Error converting logJSON to string",{error:K,data:G})}if(this.storageSettings.stratagy=="batch"&&this.storageSettings.batch>1){if(this.logBuffer.push({logTXT:Z,logJSONString:z})>=this.storageSettings.batch)this.extractBuffer(q)}else{let{dirLocation:K,logLocation:W}=this.generatePaths(q);if(!R.existsSync(K))R.mkdirSync(K,{recursive:!0});if(this.storageSettings.txt){const O=R.createWriteStream(W+"txt.log",{flags:"a"});O.write(Z+"\n"),O.end()}if(this.storageSettings.json){const O=R.createWriteStream(W+"json.log",{flags:"a"});O.write(z+"\n"),O.end()}}}generatePaths(q){let $="",Q=this.storageSettings.path;switch(this.storageSettings.splitBy){case"don't split":Q+="/",$+=Q+"logs.";break;case"year":Q+="/",$+=`${Y(q,"yyyy")}.`;break;case"month":Q+=`/${Y(q,"yyyy")}/`,$+=Q+`${Y(q,"mm")}.`;break;case"day":Q+=`/${Y(q,"yyyy/mm")}/`,$+=Q+`${Y(q,"dd")}.`;break;case"hour":Q+=`/${Y(q,"yyyy/mm/dd")}/`,$+=Q+`${Y(q,"HH")}.`;break;case"minute":Q+=`/${Y(q,"yyyy/mm/dd/HH")}/`,$+=Q+`${Y(q,"MM")}.`;break;case"second":Q+=`/${Y(q,"yyyy/mm/dd/HH/MM")}/`,$+=Q+`${Y(q,"ss")}.`;break;default:this.error("Logger split by value is invalid",this.storageSettings.splitBy);break}return{dirLocation:Q,logLocation:$}}extractBuffer(q){let{dirLocation:$,logLocation:Q}=this.generatePaths(q);if(!R.existsSync($))R.mkdirSync($,{recursive:!0});let U="",X="",Z=this.logBuffer.length;for(let G=0;G<Z;G++){let z=this.logBuffer.shift();if(z==null)this.error("Log buffer item is empty whilst trying to read from it");else U+=z.logTXT+"\n",X+=z.logJSONString+"\n"}if(this.storageSettings.txt){const G=R.createWriteStream(Q+"txt.log",{flags:"a"});G.write(U),G.end()}if(this.storageSettings.json){const G=R.createWriteStream(Q+"json.log",{flags:"a"});G.write(X),G.end()}}handleLogDatatype(q){if(q==null)return"";const $=typeof q;if($=="string")return q;if(["bigint","boolean","number","symbol","function"].includes($))return q.toString();if($=="object")try{return JSON.stringify(q,null,4)}catch(Q){return this.error("Datatype of object is not json",{dataType:$,data:q}),""}return this.error("Datatype Error",{dataType:$,data:q}),"Datatype error"}fatal(q,$){this.sendLog("FATAL",q,$)}error(q,$){this.sendLog("ERROR",q,$)}err=this.error;warn(q,$){this.sendLog("WARN",q,$)}success(q,$){this.sendLog("SUCCESS",q,$)}info(q,$){this.sendLog("INFO",q,$)}log=this.info;debug(q,$){this.sendLog("DEBUG",q,$)}exit(){if(this.storageSettings.stratagy=="batch")try{const q=new Date;this.extractBuffer(q),console.log("ready to shutdown")}catch(q){console.error("There was an issue clearing the buffer",q)}}}export{N0 as default};
